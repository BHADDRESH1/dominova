<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Color Extractor</title>
</head>

<body>
    <img id="targetImg" src="./logo_to_analyze.png" style="display:none;" crossorigin="anonymous">
    <canvas id="canvas"></canvas>
    <div id="results">Analyzing...</div>

    <script>
        window.onload = function () {
            const img = document.getElementById('targetImg');
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            const resultsDiv = document.getElementById('results');

            canvas.width = img.width;
            canvas.height = img.height;
            ctx.drawImage(img, 0, 0, img.width, img.height);

            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            const colorCounts = {};

            for (let i = 0; i < data.length; i += 4) {
                const r = data[i];
                const g = data[i + 1];
                const b = data[i + 2];
                const a = data[i + 3];

                // Skip transparent or near-transparent pixels
                if (a < 128) continue;

                // Skip white-ish pixels (often background)
                if (r > 240 && g > 240 && b > 240) continue;

                // Skip black-ish pixels (often text/outlines, maybe we want this?)
                // Let's keep dark colors as they might be the primary brand color.

                const rgb = `${r},${g},${b}`;
                colorCounts[rgb] = (colorCounts[rgb] || 0) + 1;
            }

            const sortedColors = Object.entries(colorCounts)
                .sort(([, a], [, b]) => b - a)
                .slice(0, 5)
                .map(([rgb]) => {
                    const [r, g, b] = rgb.split(',').map(Number);
                    return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase();
                });

            resultsDiv.innerText = JSON.stringify(sortedColors);
        };
    </script>
</body>

</html>